# ESP32 Flight Controller  

I have chosen ESP32 as a flight controller mainly because of its cost, WiFi & BLE capabilities. Which one can exploit to integrate with ROS. 

## Code Files  

1. **Anglemode_flightcontroller_ver3**  
   - This is the complete code for the ESP32 flight controller. You may need to upload additional libraries in your Arduino IDE. Before uploading the code to the ESP32.

2. **receiver_pwm_esp32**  
   - This code is used to independently test the receiver & transmitter signals on the serial monitor. Connect the receiver to the ESP32 board as mentioned in the schematic.  

3. **measure_angles_mpu**  
   - This is an IMU angle checker. Connect the IMU to the ESP32 via the I2C protocol as specified in the schematic.  

4. **Motors calibration**  
   - Use this code to calibrate the motor's ESCs before the flight. This ensures that all motors start simultaneously. Follow the proper ESC calibration procedure while using this code.  

5. **Voltage measurement esp32**  
   - This code measures the voltage level of the LiPo 11V battery. You may need to adjust the code to match the actual resistor values used in your circuit.  

---

## Testing  

Before attempting flight, ensure all components are functioning correctly by testing them individually using the codes provided in the **testing folder**:  

- Use **receiver_pwm_esp32** to verify the signals from the receiver and transmitter.  
- Use **measure_angles_mpu** to confirm the IMU is measuring angles accurately.  
- Use **Motors calibration** to calibrate all ESCs and ensure motors are properly synchronized.  
- Use **Voltage measurement esp32** to validate the voltage sensing circuit. This part is not yet impleneted in the main FC code.

---

## Flying  

Before flying the drone, follow these steps:  

1. **IMU Calibration**  
   - Run the calibration code from the **/ESP32-Flight-controller-/src/Gyro_accelerometer_calibration.ino** to calibrate the IMU. Ensure the quadcopter is on a level surface during this process.  
   - Record the calibrated values generated by the calibration code, check the serial monitor.

2. **Update the Main Flight Code**  
   - Enter the calibrated IMU values into the **/ESP32-Flight-controller-/src/Anglemode_flightcontroller_ver3.ino** code's void Setup() with these values before uploading it to the ESP32.  

3. **Prepare for Flight**  
   - Double-check motor rotations and propeller    orientations as per the schematic.  
   - Ensure all connections are secure.  
   - Perform an initial outdoor test for safety.  

4. You're Ready!

---

## Safety First  

The quadcopter motors and propellers possess significant destructive energy. Always:  
- Conduct initial tests outdoors.  
- Verify that all propellers are installed in the correct direction and that motor rotations match the schematic.  
- Recheck motor and propeller functionality before uploading the main flight code.  

---

## YouTube Video Links  

- [Flight Demonstration](https://youtu.be/PweCWXNrxg0?si=KJHE-g0SIH3p4Ixf)  

- [Understanding PID Controller](https://youtu.be/dMRDzicSvXk?si=4SlX_EvzxvCbH7zv)

- [Tuning of PID Controller gains via ESP32 webserver WiFi](https://youtu.be/kl3Dlm11AEQ?si=NrJVn8WFx9-ViMtl)


## References
- [Joop Brooking](https://www.youtube.com/@Joop_Brokking)  
- [Carbon Aeronautics](https://youtube.com/@carbonaeronautics?si=-DZ1Sz5sgNruoJgR)

